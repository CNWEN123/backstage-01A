# äºŒã€æµç¨‹ä¸æ§åˆ¶ç±»åŠŸèƒ½ï¼šè®©è¿è¥ã€Œç¨³ã€èµ·æ¥

**æ–‡æ¡£ç±»å‹**: åŠŸèƒ½è¯¦è§£æ–‡æ¡£  
**åŠŸèƒ½åˆ†ç±»**: æµç¨‹ç®¡æ§ä¸ç³»ç»Ÿæ§åˆ¶  
**æ ¸å¿ƒä»·å€¼**: è§„èŒƒæ“ä½œæµç¨‹ï¼Œä¿éšœç³»ç»Ÿç¨³å®š  
**æ›´æ–°æ—¥æœŸ**: 2025-12-13

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æµç¨‹ä¸æ§åˆ¶ç±»åŠŸèƒ½æ—¨åœ¨**å»ºç«‹è§„èŒƒçš„æ“ä½œæµç¨‹**ï¼Œé€šè¿‡å®¡æ ¸å·¥ä½œæµã€ç³»ç»Ÿé…ç½®ã€åŠŸèƒ½å¼€å…³ç­‰æ‰‹æ®µï¼Œç¡®ä¿è¿è¥æ“ä½œçš„**è§„èŒƒæ€§ã€å¯æ§æ€§ã€ç¨³å®šæ€§**ã€‚

### æ ¸å¿ƒä»·å€¼
- ğŸ›¡ï¸ **è§„èŒƒæ“ä½œæµç¨‹** - ä»éšæ„æ“ä½œåˆ°æµç¨‹åŒ–ç®¡ç†
- âš¡ **ç´§æ€¥å“åº”èƒ½åŠ›** - ä»å°æ—¶çº§åˆ°ç§’çº§å“åº”
- ğŸ¯ **çµæ´»é…ç½®ç®¡ç†** - ä»ç¡¬ç¼–ç åˆ°åŠ¨æ€é…ç½®
- ğŸ“‹ **æ ‡å‡†åŒ–å¤„ç†** - ä»äººå·¥å†³ç­–åˆ°æ¨¡æ¿åŒ–æ“ä½œ

---

## åŠŸèƒ½æ¸…å•

| åŠŸèƒ½ç¼–å· | åŠŸèƒ½åç§° | æ ¸å¿ƒä»·å€¼ | ä¼˜å…ˆçº§ |
|---------|---------|---------|--------|
| 2.1.1 | å®¡æ ¸å·¥ä½œæµ | ä»»åŠ¡åˆ†é…ã€å¿«é€Ÿåé¦ˆã€å†å²å¯¹æ¯” | ğŸ”¥ğŸ”¥ |
| 2.1.3 | æ‹’ç»åŸå› æ¨¡ç‰ˆ | å¿«é€Ÿé€‰æ‹©æ‹’ç»åŸå›  | ğŸ”¥ğŸ”¥ |
| 2.1.5 | å†å²è¿è§„è®°å½• | å®¡æ ¸æ—¶æ˜¾ç¤ºå†å²æƒ…å†µ | ğŸ”¥ğŸ”¥ |
| 2.2.3 | ç³»ç»Ÿå‚æ•°é…ç½® | åå°é…ç½®ä¸šåŠ¡å‚æ•° | ğŸ”¥ğŸ”¥ğŸ”¥ |
| 2.2.4 | æ–‡æ¡ˆé…ç½® | åå°é…ç½®ç³»ç»Ÿæç¤ºè¯­ | ğŸ”¥ğŸ”¥ |
| 2.2.6 | åŠŸèƒ½å¼€å…³ | ä¸€é”®å¼€å¯/å…³é—­ç³»ç»ŸåŠŸèƒ½ | ğŸ”¥ğŸ”¥ğŸ”¥ |
| 2.2.7 | ç»´æŠ¤æ¨¡å¼ | å¼€å¯ç»´æŠ¤æ¨¡å¼å¹¶æ˜¾ç¤ºå…¬å‘Š | ğŸ”¥ğŸ”¥ğŸ”¥ |
| 2.2.8 | é€šçŸ¥æ¨é€ç³»ç»Ÿ | å®šå‘æ¨é€ã€åˆ†ç»„å‘é€ã€å®šæ—¶å‘é€ | ğŸ”¥ğŸ”¥ |

---

## è¯¦ç»†åŠŸèƒ½è¯´æ˜

### 1ï¸âƒ£ åŠŸèƒ½å¼€å…³ï¼ˆåŠŸèƒ½ç¼–å·ï¼š2.2.6ï¼‰

#### å½“å‰ç—›ç‚¹
- å‘ç°é‡å¤§Bugéœ€è¦ç´§æ€¥å…³é—­åŠŸèƒ½æ—¶ï¼Œ**å¿…é¡»ä¿®æ”¹ä»£ç é‡æ–°éƒ¨ç½²**
- ç³»ç»Ÿç»´æŠ¤æ—¶æ— æ³•ä¸´æ—¶å…³é—­å……å€¼/ææ¬¾å…¥å£
- å¤œé—´å‡ºç°é—®é¢˜æ—¶ï¼Œå¼€å‘äººå‘˜éœ€è¦**ç´§æ€¥ä¸Šçº¿**
- æ— æ³•å¿«é€Ÿå“åº”çªå‘æƒ…å†µ

#### åŠŸèƒ½è®¾è®¡

**ç³»ç»Ÿè®¾ç½® â†’ åŠŸèƒ½å¼€å…³ç®¡ç†**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŠŸèƒ½å¼€å…³ç®¡ç†                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ ¸å¿ƒåŠŸèƒ½å¼€å…³ï¼š                                       â”‚
â”‚                                                     â”‚
â”‚ [âˆš] å……å€¼åŠŸèƒ½          [å¯ç”¨ä¸­]  [å…³é—­]              â”‚
â”‚     â””â”€ å…³é—­åç©å®¶æ— æ³•è¿›è¡Œå……å€¼æ“ä½œ                    â”‚
â”‚     â””â”€ æœ€åä¿®æ”¹ï¼šadmin  2025-12-13 14:30           â”‚
â”‚                                                     â”‚
â”‚ [âˆš] ææ¬¾åŠŸèƒ½          [å¯ç”¨ä¸­]  [å…³é—­]              â”‚
â”‚     â””â”€ å…³é—­åç©å®¶æ— æ³•æäº¤ææ¬¾ç”³è¯·                    â”‚
â”‚     â””â”€ æœ€åä¿®æ”¹ï¼šadmin  2025-12-13 14:30           â”‚
â”‚                                                     â”‚
â”‚ [âˆš] æ¸¸æˆæŠ•æ³¨          [å¯ç”¨ä¸­]  [å…³é—­]              â”‚
â”‚     â””â”€ å…³é—­åç©å®¶æ— æ³•è¿›è¡Œæ¸¸æˆæŠ•æ³¨                    â”‚
â”‚     â””â”€ æœ€åä¿®æ”¹ï¼šadmin  2025-12-13 14:30           â”‚
â”‚                                                     â”‚
â”‚ [ ] ä»£ç†æ³¨å†Œ          [å·²å…³é—­]  [å¯ç”¨]              â”‚
â”‚     â””â”€ å…³é—­åæ— æ³•æ³¨å†Œæ–°ä»£ç†                          â”‚
â”‚     â””â”€ æœ€åä¿®æ”¹ï¼šadmin  2025-12-12 10:00           â”‚
â”‚                                                     â”‚
â”‚ [âˆš] ç©å®¶æ³¨å†Œ          [å¯ç”¨ä¸­]  [å…³é—­]              â”‚
â”‚     â””â”€ å…³é—­åæ— æ³•æ³¨å†Œæ–°ç©å®¶                          â”‚
â”‚     â””â”€ æœ€åä¿®æ”¹ï¼šadmin  2025-12-11 09:15           â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é«˜çº§åŠŸèƒ½å¼€å…³ï¼š                                       â”‚
â”‚                                                     â”‚
â”‚ [âˆš] æ´—ç ç”³è¯·          [å¯ç”¨ä¸­]  [å…³é—­]              â”‚
â”‚ [ ] çº¢åˆ©å‘æ”¾          [å·²å…³é—­]  [å¯ç”¨]              â”‚
â”‚ [âˆš] åœ¨çº¿å®¢æœ          [å¯ç”¨ä¸­]  [å…³é—­]              â”‚
â”‚ [âˆš] æ¨å¹¿é“¾æ¥          [å¯ç”¨ä¸­]  [å…³é—­]              â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ“ä½œæ—¥å¿—ï¼š                                           â”‚
â”‚ 2025-12-13 14:30  admin  å…³é—­äº†"ä»£ç†æ³¨å†Œ"åŠŸèƒ½       â”‚
â”‚ 2025-12-12 10:00  admin  å¼€å¯äº†"å……å€¼åŠŸèƒ½"           â”‚
â”‚ 2025-12-11 09:15  admin  å…³é—­äº†"çº¢åˆ©å‘æ”¾"åŠŸèƒ½       â”‚
â”‚                                                     â”‚
â”‚ [æŸ¥çœ‹å®Œæ•´æ—¥å¿—]                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½å¼€å…³ç¡®è®¤å¼¹çª—**
```
âš ï¸ ç¡®è®¤å…³é—­"å……å€¼åŠŸèƒ½"

æ­¤æ“ä½œå°†å¯¼è‡´ï¼š
  âœ“ æ‰€æœ‰ç©å®¶æ— æ³•è¿›è¡Œå……å€¼æ“ä½œ
  âœ“ å……å€¼é¡µé¢å°†æ˜¾ç¤º"å……å€¼åŠŸèƒ½æš‚æ—¶å…³é—­"æç¤º
  âœ“ æ­£åœ¨è¿›è¡Œçš„å……å€¼è®¢å•ä¸å—å½±å“
  âœ“ ç®¡ç†å‘˜ä»å¯æ‰‹åŠ¨ä¸ºç©å®¶å……å€¼

å…³é—­åŸå› ï¼ˆå¿…å¡«ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ç³»ç»Ÿç»´æŠ¤ â–¼]                                    â”‚
â”‚                                                 â”‚
â”‚ è¯¦ç»†è¯´æ˜ï¼š                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ”¯ä»˜é€šé“å‡çº§ç»´æŠ¤ï¼Œé¢„è®¡1å°æ—¶åæ¢å¤           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[ ] åŒæ—¶å‘é€ç³»ç»Ÿå…¬å‘Šé€šçŸ¥ç©å®¶

[å–æ¶ˆ] [ç¡®è®¤å…³é—­]
```

#### æŠ€æœ¯å®ç°

**æ•°æ®åº“è¡¨è®¾è®¡**
```sql
-- åŠŸèƒ½å¼€å…³é…ç½®è¡¨
CREATE TABLE system_toggles (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  toggle_key TEXT UNIQUE NOT NULL,      -- å¼€å…³æ ‡è¯†ï¼šdeposit, withdrawal, betting
  toggle_name TEXT NOT NULL,             -- å¼€å…³åç§°ï¼šå……å€¼åŠŸèƒ½ã€ææ¬¾åŠŸèƒ½
  is_enabled INTEGER DEFAULT 1,          -- æ˜¯å¦å¯ç”¨ï¼š1=å¯ç”¨ï¼Œ0=å…³é—­
  description TEXT,                      -- åŠŸèƒ½æè¿°
  disabled_reason TEXT,                  -- å…³é—­åŸå› 
  last_modified_by INTEGER,              -- æœ€åä¿®æ”¹äºº
  last_modified_at DATETIME,             -- æœ€åä¿®æ”¹æ—¶é—´
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- åˆå§‹åŒ–æ•°æ®
INSERT INTO system_toggles (toggle_key, toggle_name, description) VALUES
  ('deposit', 'å……å€¼åŠŸèƒ½', 'æ§åˆ¶ç©å®¶å……å€¼å…¥å£'),
  ('withdrawal', 'ææ¬¾åŠŸèƒ½', 'æ§åˆ¶ç©å®¶ææ¬¾ç”³è¯·'),
  ('betting', 'æ¸¸æˆæŠ•æ³¨', 'æ§åˆ¶æ¸¸æˆæŠ•æ³¨åŠŸèƒ½'),
  ('agent_register', 'ä»£ç†æ³¨å†Œ', 'æ§åˆ¶ä»£ç†æ³¨å†Œå…¥å£'),
  ('player_register', 'ç©å®¶æ³¨å†Œ', 'æ§åˆ¶ç©å®¶æ³¨å†Œå…¥å£');
```

**åç«¯APIå®ç°**
```typescript
// è·å–æ‰€æœ‰åŠŸèƒ½å¼€å…³çŠ¶æ€
app.get('/api/system/toggles', async (c) => {
  const { DB } = c.env
  const toggles = await DB.prepare(`
    SELECT * FROM system_toggles ORDER BY id
  `).all()
  
  return c.json({ toggles: toggles.results })
})

// æ›´æ–°åŠŸèƒ½å¼€å…³çŠ¶æ€
app.put('/api/system/toggles/:key', async (c) => {
  const { DB } = c.env
  const { key } = c.req.param()
  const { is_enabled, reason, operator_id } = await c.req.json()
  
  // æ›´æ–°å¼€å…³çŠ¶æ€
  await DB.prepare(`
    UPDATE system_toggles 
    SET is_enabled = ?,
        disabled_reason = ?,
        last_modified_by = ?,
        last_modified_at = CURRENT_TIMESTAMP
    WHERE toggle_key = ?
  `).bind(is_enabled, reason, operator_id, key).run()
  
  // è®°å½•å®¡è®¡æ—¥å¿—
  await DB.prepare(`
    INSERT INTO audit_logs (operator_id, module, action, description)
    VALUES (?, 'system_toggle', ?, ?)
  `).bind(
    operator_id, 
    is_enabled ? 'enable' : 'disable',
    `${is_enabled ? 'å¼€å¯' : 'å…³é—­'}åŠŸèƒ½å¼€å…³: ${key}`
  ).run()
  
  return c.json({ success: true })
})

// ä¸­é—´ä»¶ï¼šæ£€æŸ¥åŠŸèƒ½æ˜¯å¦å¼€å¯
function checkToggle(toggleKey: string) {
  return async (c, next) => {
    const { DB } = c.env
    
    const toggle = await DB.prepare(`
      SELECT is_enabled FROM system_toggles WHERE toggle_key = ?
    `).bind(toggleKey).first()
    
    if (!toggle || !toggle.is_enabled) {
      return c.json({ 
        error: 'è¯¥åŠŸèƒ½æš‚æ—¶å…³é—­',
        reason: toggle?.disabled_reason || 'ç³»ç»Ÿç»´æŠ¤ä¸­'
      }, 403)
    }
    
    await next()
  }
}

// åº”ç”¨åˆ°å…·ä½“API
app.post('/api/deposits', checkToggle('deposit'), async (c) => {
  // å……å€¼é€»è¾‘
})

app.post('/api/withdrawals', checkToggle('withdrawal'), async (c) => {
  // ææ¬¾é€»è¾‘
})

app.post('/api/bets', checkToggle('betting'), async (c) => {
  // æŠ•æ³¨é€»è¾‘
})
```

**å‰ç«¯å®æ—¶æ£€æµ‹**
```typescript
// å®šæœŸæ£€æŸ¥åŠŸèƒ½å¼€å…³çŠ¶æ€ï¼ˆè½®è¯¢ï¼‰
async function checkToggles() {
  const response = await fetch('/api/system/toggles/public')
  const { toggles } = await response.json()
  
  // æ›´æ–°å…¨å±€çŠ¶æ€
  const disabledFeatures = toggles
    .filter(t => !t.is_enabled)
    .map(t => t.toggle_key)
  
  // å¦‚æœå……å€¼åŠŸèƒ½è¢«å…³é—­ï¼Œç¦ç”¨å……å€¼æŒ‰é’®å¹¶æ˜¾ç¤ºæç¤º
  if (disabledFeatures.includes('deposit')) {
    document.querySelector('#deposit-btn').disabled = true
    showNotification('å……å€¼åŠŸèƒ½æš‚æ—¶å…³é—­ï¼š' + toggles.find(t => t.toggle_key === 'deposit').disabled_reason)
  }
}

// æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
setInterval(checkToggles, 30000)
```

#### é¢„æœŸæ”¶ç›Š
- âœ… ç´§æ€¥æƒ…å†µä¸‹ **ç§’çº§å“åº”**ï¼ˆæ— éœ€ä¿®æ”¹ä»£ç ï¼‰
- âœ… é¿å…ç´§æ€¥éƒ¨ç½²å¸¦æ¥çš„é£é™©
- âœ… è¿è¥äººå‘˜å¯è‡ªä¸»æ§åˆ¶ï¼Œæ— éœ€ç­‰å¾…å¼€å‘
- âœ… å®Œæ•´çš„æ“ä½œè®°å½•ï¼Œå¯è¿½æº¯

---

### 2ï¸âƒ£ ç»´æŠ¤æ¨¡å¼ï¼ˆåŠŸèƒ½ç¼–å·ï¼š2.2.7ï¼‰

#### ä¸šåŠ¡åœºæ™¯
- ç³»ç»Ÿå‡çº§ç»´æŠ¤æ—¶éœ€è¦é€šçŸ¥ç©å®¶
- æ•°æ®åº“è¿ç§»æ—¶éœ€è¦æš‚åœæœåŠ¡
- é‡å¤§åŠŸèƒ½ä¸Šçº¿æ—¶éœ€è¦ä¿æŠ¤æ•°æ®
- ç´§æ€¥æ•…éšœå¤„ç†æ—¶éœ€è¦æš‚åœæœåŠ¡

#### åŠŸèƒ½è®¾è®¡

**ç³»ç»Ÿè®¾ç½® â†’ ç»´æŠ¤æ¨¡å¼**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç»´æŠ¤æ¨¡å¼æ§åˆ¶ä¸­å¿ƒ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å½“å‰çŠ¶æ€ï¼š[ ] æœªå¯ç”¨   (â€¢) å·²å¯ç”¨                    â”‚
â”‚                                                     â”‚
â”‚ ç»´æŠ¤ä¿¡æ¯é…ç½®ï¼š                                       â”‚
â”‚                                                     â”‚
â”‚ ç»´æŠ¤æ ‡é¢˜ï¼š                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ç³»ç»Ÿå‡çº§ç»´æŠ¤é€šçŸ¥                                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ ç»´æŠ¤å…¬å‘Šï¼š                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å°Šæ•¬çš„ç”¨æˆ·ï¼š                                    â”‚ â”‚
â”‚ â”‚                                                 â”‚ â”‚
â”‚ â”‚ ä¸ºäº†ç»™æ‚¨æä¾›æ›´å¥½çš„æœåŠ¡ä½“éªŒï¼Œç³»ç»Ÿå°†è¿›è¡Œå‡çº§ç»´æŠ¤ã€‚â”‚ â”‚
â”‚ â”‚ ç»´æŠ¤æœŸé—´æš‚åœæ‰€æœ‰æœåŠ¡ï¼Œæ•¬è¯·è°…è§£ã€‚                â”‚ â”‚
â”‚ â”‚                                                 â”‚ â”‚
â”‚ â”‚ ç»´æŠ¤æ—¶é—´ï¼š2025-12-13 22:00 - 24:00 (é¢„è®¡2å°æ—¶) â”‚ â”‚
â”‚ â”‚                                                 â”‚ â”‚
â”‚ â”‚ å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»åœ¨çº¿å®¢æœã€‚                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ é¢„è®¡æ¢å¤æ—¶é—´ï¼š                                       â”‚
â”‚ [2025-12-13] [24:00]                                â”‚
â”‚                                                     â”‚
â”‚ ç»´æŠ¤æœŸé—´æ•ˆæœï¼š                                       â”‚
â”‚ [âˆš] ç©å®¶å‰ç«¯æ˜¾ç¤ºç»´æŠ¤å…¬å‘Š                             â”‚
â”‚ [âˆš] ç¦æ­¢ç©å®¶ç™»å½•ï¼ˆå·²ç™»å½•ç©å®¶è‡ªåŠ¨ç™»å‡ºï¼‰               â”‚
â”‚ [âˆš] ç¦æ­¢æ‰€æœ‰ç©å®¶æ“ä½œï¼ˆå……å€¼/ææ¬¾/æŠ•æ³¨ï¼‰               â”‚
â”‚ [ ] ç®¡ç†å‘˜å¯æ­£å¸¸ç™»å½•                                 â”‚
â”‚ [âˆš] APIè¿”å›503çŠ¶æ€ç                                  â”‚
â”‚                                                     â”‚
â”‚ è‡ªåŠ¨æ¢å¤ï¼š                                           â”‚
â”‚ [âˆš] åˆ°è¾¾é¢„è®¡æ¢å¤æ—¶é—´åè‡ªåŠ¨é€€å‡ºç»´æŠ¤æ¨¡å¼               â”‚
â”‚ [ ] éœ€è¦æ‰‹åŠ¨å…³é—­ç»´æŠ¤æ¨¡å¼                             â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [é¢„è§ˆæ•ˆæœ] [å¼€å¯ç»´æŠ¤æ¨¡å¼] [å…³é—­ç»´æŠ¤æ¨¡å¼]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç©å®¶ç«¯ç»´æŠ¤é¡µé¢**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                     â”‚
â”‚               ğŸ”§ ç³»ç»Ÿå‡çº§ç»´æŠ¤é€šçŸ¥                    â”‚
â”‚                                                     â”‚
â”‚     å°Šæ•¬çš„ç”¨æˆ·ï¼š                                     â”‚
â”‚                                                     â”‚
â”‚     ä¸ºäº†ç»™æ‚¨æä¾›æ›´å¥½çš„æœåŠ¡ä½“éªŒï¼Œç³»ç»Ÿå°†è¿›è¡Œå‡çº§ç»´æŠ¤ã€‚ â”‚
â”‚     ç»´æŠ¤æœŸé—´æš‚åœæ‰€æœ‰æœåŠ¡ï¼Œæ•¬è¯·è°…è§£ã€‚                 â”‚
â”‚                                                     â”‚
â”‚     ç»´æŠ¤æ—¶é—´ï¼š2025-12-13 22:00 - 24:00 (é¢„è®¡2å°æ—¶)  â”‚
â”‚                                                     â”‚
â”‚     é¢„è®¡æ¢å¤æ—¶é—´ï¼š                                   â”‚
â”‚                                                     â”‚
â”‚           â° 2025-12-13 24:00                       â”‚
â”‚                                                     â”‚
â”‚     å€’è®¡æ—¶ï¼š01:45:32                                â”‚
â”‚                                                     â”‚
â”‚     å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»ï¼š                               â”‚
â”‚     ğŸ“ å®¢æœçƒ­çº¿ï¼š400-xxx-xxxx                        â”‚
â”‚     ğŸ’¬ åœ¨çº¿å®¢æœï¼šhttps://...                         â”‚
â”‚                                                     â”‚
â”‚     æ„Ÿè°¢æ‚¨çš„ç†è§£ä¸æ”¯æŒï¼                             â”‚
â”‚                                                     â”‚
â”‚                      [è¿”å›é¦–é¡µ]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€æœ¯å®ç°

**æ•°æ®åº“è¡¨è®¾è®¡**
```sql
-- ç»´æŠ¤æ¨¡å¼é…ç½®è¡¨
CREATE TABLE maintenance_config (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  is_enabled INTEGER DEFAULT 0,         -- æ˜¯å¦å¯ç”¨ç»´æŠ¤æ¨¡å¼
  title TEXT,                           -- ç»´æŠ¤æ ‡é¢˜
  message TEXT,                         -- ç»´æŠ¤å…¬å‘Š
  start_time DATETIME,                  -- ç»´æŠ¤å¼€å§‹æ—¶é—´
  end_time DATETIME,                    -- é¢„è®¡ç»“æŸæ—¶é—´
  auto_restore INTEGER DEFAULT 1,       -- æ˜¯å¦è‡ªåŠ¨æ¢å¤
  allow_admin INTEGER DEFAULT 1,        -- æ˜¯å¦å…è®¸ç®¡ç†å‘˜ç™»å½•
  enabled_by INTEGER,                   -- å¼€å¯äºº
  enabled_at DATETIME,                  -- å¼€å¯æ—¶é—´
  disabled_by INTEGER,                  -- å…³é—­äºº
  disabled_at DATETIME                  -- å…³é—­æ—¶é—´
);
```

**åç«¯å®ç°**
```typescript
// å…¨å±€ä¸­é—´ä»¶ï¼šç»´æŠ¤æ¨¡å¼æ£€æµ‹
app.use('*', async (c, next) => {
  const { DB } = c.env
  const path = c.req.path
  
  // ç®¡ç†åå°è·¯å¾„å’Œå¥åº·æ£€æŸ¥è·¯å¾„è·³è¿‡
  if (path.startsWith('/admin') || path === '/health') {
    return next()
  }
  
  // æ£€æŸ¥ç»´æŠ¤æ¨¡å¼
  const config = await DB.prepare(`
    SELECT * FROM maintenance_config WHERE id = 1
  `).first()
  
  if (config && config.is_enabled) {
    // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾è‡ªåŠ¨æ¢å¤æ—¶é—´
    if (config.auto_restore && config.end_time) {
      const now = new Date()
      const endTime = new Date(config.end_time)
      
      if (now >= endTime) {
        // è‡ªåŠ¨å…³é—­ç»´æŠ¤æ¨¡å¼
        await DB.prepare(`
          UPDATE maintenance_config SET is_enabled = 0 WHERE id = 1
        `).run()
        
        return next()
      }
    }
    
    // è¿”å›ç»´æŠ¤é¡µé¢
    return c.html(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>${config.title || 'ç³»ç»Ÿç»´æŠ¤ä¸­'}</title>
        <meta charset="utf-8">
        <style>
          body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
            background: #f5f5f5;
          }
          .maintenance-box {
            background: white;
            padding: 40px;
            border-radius: 10px;
            max-width: 600px;
            margin: 0 auto;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          }
          .icon { font-size: 48px; margin-bottom: 20px; }
          .countdown { font-size: 32px; font-weight: bold; color: #ff6b6b; margin: 20px 0; }
        </style>
      </head>
      <body>
        <div class="maintenance-box">
          <div class="icon">ğŸ”§</div>
          <h1>${config.title || 'ç³»ç»Ÿç»´æŠ¤ä¸­'}</h1>
          <p>${config.message || 'ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤ï¼Œè¯·ç¨åè®¿é—®'}</p>
          ${config.end_time ? `
            <div class="countdown" id="countdown"></div>
            <script>
              const endTime = new Date('${config.end_time}').getTime();
              setInterval(() => {
                const now = new Date().getTime();
                const distance = endTime - now;
                if (distance < 0) {
                  location.reload();
                  return;
                }
                const hours = Math.floor(distance / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                document.getElementById('countdown').innerHTML = 
                  hours.toString().padStart(2, '0') + ':' + 
                  minutes.toString().padStart(2, '0') + ':' + 
                  seconds.toString().padStart(2, '0');
              }, 1000);
            </script>
          ` : ''}
        </div>
      </body>
      </html>
    `, 503)
  }
  
  await next()
})

// å¼€å¯/å…³é—­ç»´æŠ¤æ¨¡å¼ API
app.put('/admin/api/maintenance', async (c) => {
  const { DB } = c.env
  const { is_enabled, title, message, end_time, operator_id } = await c.req.json()
  
  await DB.prepare(`
    UPDATE maintenance_config 
    SET is_enabled = ?,
        title = ?,
        message = ?,
        end_time = ?,
        ${is_enabled ? 'enabled_by' : 'disabled_by'} = ?,
        ${is_enabled ? 'enabled_at' : 'disabled_at'} = CURRENT_TIMESTAMP
    WHERE id = 1
  `).bind(is_enabled, title, message, end_time, operator_id).run()
  
  return c.json({ success: true })
})
```

#### é¢„æœŸæ”¶ç›Š
- âœ… ç³»ç»Ÿç»´æŠ¤æ—¶ä½“éªŒæ›´ä¸“ä¸š
- âœ… é¿å…ç©å®¶åœ¨ç»´æŠ¤æœŸé—´æ“ä½œå¯¼è‡´æ•°æ®å¼‚å¸¸
- âœ… è‡ªåŠ¨å®šæ—¶æ¢å¤ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
- âœ… æ¸…æ™°çš„å€’è®¡æ—¶æç¤ºï¼Œå‡å°‘å®¢è¯‰

---

### 3ï¸âƒ£ ç³»ç»Ÿå‚æ•°é…ç½®ï¼ˆåŠŸèƒ½ç¼–å·ï¼š2.2.3ï¼‰

#### å½“å‰ç—›ç‚¹
- ä¸šåŠ¡å‚æ•°ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
- è°ƒæ•´å‚æ•°éœ€è¦ä¿®æ”¹ä»£ç é‡æ–°éƒ¨ç½²
- è¿è¥æ— æ³•è‡ªä¸»è°ƒæ•´ä¸šåŠ¡è§„åˆ™
- ä¸åŒç¯å¢ƒï¼ˆæµ‹è¯•/ç”Ÿäº§ï¼‰é…ç½®æ··ä¹±

#### åŠŸèƒ½è®¾è®¡

**ç³»ç»Ÿè®¾ç½® â†’ å‚æ•°é…ç½®**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç³»ç»Ÿå‚æ•°é…ç½®                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è´¢åŠ¡å‚æ•°ï¼š                                           â”‚
â”‚                                                     â”‚
â”‚ å……å€¼è®¾ç½®ï¼š                                           â”‚
â”‚   æœ€å°å……å€¼é‡‘é¢ï¼š    [100] å…ƒ                        â”‚
â”‚   æœ€å¤§å……å€¼é‡‘é¢ï¼š    [50000] å…ƒ                      â”‚
â”‚   å……å€¼æ‰‹ç»­è´¹ç‡ï¼š    [0] %                           â”‚
â”‚                                                     â”‚
â”‚ ææ¬¾è®¾ç½®ï¼š                                           â”‚
â”‚   æœ€å°ææ¬¾é‡‘é¢ï¼š    [200] å…ƒ                        â”‚
â”‚   æœ€å¤§ææ¬¾é‡‘é¢ï¼š    [100000] å…ƒ                     â”‚
â”‚   ææ¬¾æ‰‹ç»­è´¹ç‡ï¼š    [0.5] %                         â”‚
â”‚   æ¯æ—¥ææ¬¾æ¬¡æ•°é™åˆ¶ï¼š[3] æ¬¡                          â”‚
â”‚   ææ¬¾éœ€è¦æµæ°´å€æ•°ï¼š[1] å€                          â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¸¸æˆå‚æ•°ï¼š                                           â”‚
â”‚                                                     â”‚
â”‚ æŠ•æ³¨è®¾ç½®ï¼š                                           â”‚
â”‚   æœ€å°æŠ•æ³¨é‡‘é¢ï¼š    [10] å…ƒ                         â”‚
â”‚   æœ€å¤§æŠ•æ³¨é‡‘é¢ï¼š    [50000] å…ƒ                      â”‚
â”‚   é»˜è®¤æ´—ç ç‡ï¼š      [0.6] %                         â”‚
â”‚   é»˜è®¤è¿”æ°´æ¯”ä¾‹ï¼š    [0.3] %                         â”‚
â”‚                                                     â”‚
â”‚ VIPè®¾ç½®ï¼š                                            â”‚
â”‚   VIP1å‡çº§è¦æ±‚ï¼š    [ç´¯è®¡å……å€¼1ä¸‡å…ƒ]                 â”‚
â”‚   VIP2å‡çº§è¦æ±‚ï¼š    [ç´¯è®¡å……å€¼5ä¸‡å…ƒ]                 â”‚
â”‚   VIP3å‡çº§è¦æ±‚ï¼š    [ç´¯è®¡å……å€¼10ä¸‡å…ƒ]                â”‚
â”‚   VIP4å‡çº§è¦æ±‚ï¼š    [ç´¯è®¡å……å€¼50ä¸‡å…ƒ]                â”‚
â”‚   VIP5å‡çº§è¦æ±‚ï¼š    [ç´¯è®¡å……å€¼100ä¸‡å…ƒ]               â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è”ç³»æ–¹å¼ï¼š                                           â”‚
â”‚                                                     â”‚
â”‚   å®¢æœç”µè¯ï¼š        [400-xxx-xxxx]                  â”‚
â”‚   å®¢æœå¾®ä¿¡ï¼š        [kefu_xxx]                      â”‚
â”‚   åœ¨çº¿å®¢æœé“¾æ¥ï¼š    [https://...]                   â”‚
â”‚   Telegramç¾¤ç»„ï¼š    [@xxx_official]                 â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç³»ç»Ÿæ–‡æ¡ˆï¼š                                           â”‚
â”‚                                                     â”‚
â”‚   ä½™é¢ä¸è¶³æç¤ºï¼š                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ æ‚¨çš„ä½™é¢ä¸è¶³ï¼Œè¯·å…ˆå……å€¼åå†è¿›è¡ŒæŠ•æ³¨          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                     â”‚
â”‚   ææ¬¾æˆåŠŸæç¤ºï¼š                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ææ¬¾ç”³è¯·å·²æäº¤ï¼Œé¢„è®¡1-3ä¸ªå·¥ä½œæ—¥å†…åˆ°è´¦      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                     â”‚
â”‚   æŠ•æ³¨æˆåŠŸæç¤ºï¼š                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ æŠ•æ³¨æˆåŠŸï¼Œç¥æ‚¨å¥½è¿ï¼                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ä¿å­˜é…ç½®] [æ¢å¤é»˜è®¤] [å¯¼å‡ºé…ç½®] [å¯¼å…¥é…ç½®]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€æœ¯å®ç°

**æ•°æ®åº“è¡¨è®¾è®¡**
```sql
-- ç³»ç»Ÿé…ç½®è¡¨ï¼ˆKey-Valueç»“æ„ï¼‰
CREATE TABLE system_config (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  config_key TEXT UNIQUE NOT NULL,      -- é…ç½®é”®
  config_value TEXT,                    -- é…ç½®å€¼ï¼ˆJSONæ ¼å¼ï¼‰
  config_type TEXT,                     -- é…ç½®ç±»å‹ï¼šstring, number, boolean, json
  category TEXT,                        -- åˆ†ç±»ï¼šfinance, game, contact, text
  label TEXT,                           -- æ˜¾ç¤ºæ ‡ç­¾
  description TEXT,                     -- è¯´æ˜
  is_editable INTEGER DEFAULT 1,        -- æ˜¯å¦å¯ç¼–è¾‘
  updated_by INTEGER,                   -- æœ€åä¿®æ”¹äºº
  updated_at DATETIME,                  -- æœ€åä¿®æ”¹æ—¶é—´
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- åˆå§‹åŒ–é…ç½®æ•°æ®
INSERT INTO system_config (config_key, config_value, config_type, category, label) VALUES
  -- è´¢åŠ¡å‚æ•°
  ('deposit_min', '100', 'number', 'finance', 'æœ€å°å……å€¼é‡‘é¢'),
  ('deposit_max', '50000', 'number', 'finance', 'æœ€å¤§å……å€¼é‡‘é¢'),
  ('withdrawal_min', '200', 'number', 'finance', 'æœ€å°ææ¬¾é‡‘é¢'),
  ('withdrawal_max', '100000', 'number', 'finance', 'æœ€å¤§ææ¬¾é‡‘é¢'),
  ('withdrawal_fee_rate', '0.5', 'number', 'finance', 'ææ¬¾æ‰‹ç»­è´¹ç‡(%)'),
  ('daily_withdrawal_limit', '3', 'number', 'finance', 'æ¯æ—¥ææ¬¾æ¬¡æ•°é™åˆ¶'),
  
  -- æ¸¸æˆå‚æ•°
  ('bet_min', '10', 'number', 'game', 'æœ€å°æŠ•æ³¨é‡‘é¢'),
  ('bet_max', '50000', 'number', 'game', 'æœ€å¤§æŠ•æ³¨é‡‘é¢'),
  ('default_commission_rate', '0.6', 'number', 'game', 'é»˜è®¤æ´—ç ç‡(%)'),
  
  -- è”ç³»æ–¹å¼
  ('customer_service_phone', '400-xxx-xxxx', 'string', 'contact', 'å®¢æœç”µè¯'),
  ('customer_service_wechat', 'kefu_xxx', 'string', 'contact', 'å®¢æœå¾®ä¿¡'),
  
  -- ç³»ç»Ÿæ–‡æ¡ˆ
  ('text_balance_insufficient', 'æ‚¨çš„ä½™é¢ä¸è¶³ï¼Œè¯·å…ˆå……å€¼åå†è¿›è¡ŒæŠ•æ³¨', 'string', 'text', 'ä½™é¢ä¸è¶³æç¤º'),
  ('text_withdrawal_success', 'ææ¬¾ç”³è¯·å·²æäº¤ï¼Œé¢„è®¡1-3ä¸ªå·¥ä½œæ—¥å†…åˆ°è´¦', 'string', 'text', 'ææ¬¾æˆåŠŸæç¤º');
```

**åç«¯API**
```typescript
// è·å–æ‰€æœ‰é…ç½®ï¼ˆæŒ‰åˆ†ç±»ï¼‰
app.get('/api/system/config', async (c) => {
  const { DB } = c.env
  const configs = await DB.prepare(`
    SELECT * FROM system_config 
    WHERE is_editable = 1
    ORDER BY category, id
  `).all()
  
  // æŒ‰åˆ†ç±»ç»„ç»‡
  const grouped = {}
  for (const config of configs.results) {
    if (!grouped[config.category]) {
      grouped[config.category] = []
    }
    grouped[config.category].push({
      key: config.config_key,
      value: parseValue(config.config_value, config.config_type),
      label: config.label,
      type: config.config_type
    })
  }
  
  return c.json({ configs: grouped })
})

// æ›´æ–°é…ç½®
app.put('/api/system/config/:key', async (c) => {
  const { DB } = c.env
  const { key } = c.req.param()
  const { value, operator_id } = await c.req.json()
  
  await DB.prepare(`
    UPDATE system_config 
    SET config_value = ?,
        updated_by = ?,
        updated_at = CURRENT_TIMESTAMP
    WHERE config_key = ?
  `).bind(String(value), operator_id, key).run()
  
  // æ¸…é™¤ç¼“å­˜ï¼ˆå¦‚æœä½¿ç”¨äº†ç¼“å­˜ï¼‰
  await clearConfigCache(key)
  
  // å®¡è®¡æ—¥å¿—
  await DB.prepare(`
    INSERT INTO audit_logs (operator_id, module, action, description)
    VALUES (?, 'system_config', 'update', ?)
  `).bind(operator_id, `ä¿®æ”¹é…ç½®: ${key} = ${value}`).run()
  
  return c.json({ success: true })
})

// è¾…åŠ©å‡½æ•°ï¼šè§£æé…ç½®å€¼
function parseValue(value: string, type: string) {
  switch (type) {
    case 'number':
      return Number(value)
    case 'boolean':
      return value === 'true' || value === '1'
    case 'json':
      return JSON.parse(value)
    default:
      return value
  }
}

// è¾…åŠ©å‡½æ•°ï¼šè·å–å•ä¸ªé…ç½®ï¼ˆå¸¦ç¼“å­˜ï¼‰
const configCache = new Map()

async function getConfig(key: string, db: D1Database) {
  // å…ˆæŸ¥ç¼“å­˜
  if (configCache.has(key)) {
    return configCache.get(key)
  }
  
  // æŸ¥æ•°æ®åº“
  const config = await db.prepare(`
    SELECT config_value, config_type FROM system_config WHERE config_key = ?
  `).bind(key).first()
  
  if (!config) return null
  
  const value = parseValue(config.config_value, config.config_type)
  
  // å†™å…¥ç¼“å­˜ï¼ˆ5åˆ†é’Ÿè¿‡æœŸï¼‰
  configCache.set(key, value)
  setTimeout(() => configCache.delete(key), 5 * 60 * 1000)
  
  return value
}
```

**åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ä½¿ç”¨é…ç½®**
```typescript
// å……å€¼APIä¸­ä½¿ç”¨é…ç½®
app.post('/api/deposits', async (c) => {
  const { DB } = c.env
  const { amount } = await c.req.json()
  
  // è·å–é…ç½®
  const minAmount = await getConfig('deposit_min', DB)
  const maxAmount = await getConfig('deposit_max', DB)
  
  // éªŒè¯é‡‘é¢
  if (amount < minAmount) {
    return c.json({ 
      error: `å……å€¼é‡‘é¢ä¸èƒ½ä½äº Â¥${minAmount}` 
    }, 400)
  }
  
  if (amount > maxAmount) {
    return c.json({ 
      error: `å……å€¼é‡‘é¢ä¸èƒ½è¶…è¿‡ Â¥${maxAmount}` 
    }, 400)
  }
  
  // ... å……å€¼é€»è¾‘
})
```

#### é¢„æœŸæ”¶ç›Š
- âœ… æ— éœ€ä¿®æ”¹ä»£ç å³å¯è°ƒæ•´ä¸šåŠ¡å‚æ•°
- âœ… è¿è¥å¯è‡ªä¸»é…ç½®ï¼Œå“åº”æ›´å¿«
- âœ… å‡å°‘ç¡¬ç¼–ç ï¼Œæå‡ç³»ç»Ÿçµæ´»æ€§
- âœ… ç»Ÿä¸€é…ç½®ç®¡ç†ï¼Œé¿å…é…ç½®æ··ä¹±

---

### 4ï¸âƒ£ æ‹’ç»åŸå› æ¨¡ç‰ˆï¼ˆåŠŸèƒ½ç¼–å·ï¼š2.1.3ï¼‰

#### ä¸šåŠ¡åœºæ™¯
- ææ¬¾å®¡æ ¸æ—¶éœ€è¦å¡«å†™æ‹’ç»åŸå› 
- æ¯æ¬¡æ‰‹åŠ¨è¾“å…¥æ•ˆç‡ä½ä¸”ä¸è§„èŒƒ
- å¸¸è§æ‹’ç»åŸå› é‡å¤è¾“å…¥
- éœ€è¦è§„èŒƒåŒ–çš„æ‹’ç»åŸå› åº“

#### åŠŸèƒ½è®¾è®¡

**ææ¬¾å®¡æ ¸ - æ‹’ç»åŸå› é€‰æ‹©**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‹’ç»ææ¬¾ç”³è¯·                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ææ¬¾ä¿¡æ¯ï¼š                                           â”‚
â”‚ ç”³è¯·äººï¼šplayer123                                    â”‚
â”‚ é‡‘é¢ï¼šÂ¥1,500                                         â”‚
â”‚ ç”³è¯·æ—¶é—´ï¼š2025-12-13 14:30                          â”‚
â”‚                                                     â”‚
â”‚ æ‹’ç»åŸå› ï¼ˆå¿…é€‰ï¼‰ï¼š                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [æµæ°´ä¸è¶³ â–¼]                                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ å¸¸ç”¨åŸå› æ¨¡æ¿ï¼š                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â€¢ æµæ°´ä¸è¶³ (ä½¿ç”¨23æ¬¡)                           â”‚ â”‚
â”‚ â”‚   â”œâ”€ å……å€¼é‡‘é¢Â¥Xéœ€å®Œæˆ1å€æµæ°´æ‰å¯ææ¬¾            â”‚ â”‚
â”‚ â”‚   â””â”€ [ä½¿ç”¨æ­¤æ¨¡æ¿]                               â”‚ â”‚
â”‚ â”‚                                                 â”‚ â”‚
â”‚ â”‚ â€¢ é“¶è¡Œå¡ä¿¡æ¯ä¸ç¬¦ (ä½¿ç”¨18æ¬¡)                     â”‚ â”‚
â”‚ â”‚   â”œâ”€ é“¶è¡Œå¡æŒå¡äººå§“åä¸æ³¨å†Œå§“åä¸ä¸€è‡´           â”‚ â”‚
â”‚ â”‚   â””â”€ [ä½¿ç”¨æ­¤æ¨¡æ¿]                               â”‚ â”‚
â”‚ â”‚                                                 â”‚ â”‚
â”‚ â”‚ â€¢ é‡å¤ææ¬¾ (ä½¿ç”¨12æ¬¡)                           â”‚ â”‚
â”‚ â”‚   â”œâ”€ ä»Šæ—¥å·²ææ¬¾3æ¬¡ï¼Œå·²è¾¾æ¯æ—¥ææ¬¾æ¬¡æ•°é™åˆ¶        â”‚ â”‚
â”‚ â”‚   â””â”€ [ä½¿ç”¨æ­¤æ¨¡æ¿]                               â”‚ â”‚
â”‚ â”‚                                                 â”‚ â”‚
â”‚ â”‚ â€¢ è´¦æˆ·å¼‚å¸¸ (ä½¿ç”¨9æ¬¡)                            â”‚ â”‚
â”‚ â”‚   â”œâ”€ è´¦æˆ·å­˜åœ¨å¼‚å¸¸è¡Œä¸ºï¼Œéœ€è”ç³»å®¢æœæ ¸å®           â”‚ â”‚
â”‚ â”‚   â””â”€ [ä½¿ç”¨æ­¤æ¨¡æ¿]                               â”‚ â”‚
â”‚ â”‚                                                 â”‚ â”‚
â”‚ â”‚ â€¢ æœªå®Œæˆå®åè®¤è¯ (ä½¿ç”¨7æ¬¡)                      â”‚ â”‚
â”‚ â”‚   â”œâ”€ è¯·å…ˆå®Œæˆå®åè®¤è¯åå†ç”³è¯·ææ¬¾               â”‚ â”‚
â”‚ â”‚   â””â”€ [ä½¿ç”¨æ­¤æ¨¡æ¿]                               â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ è¯¦ç»†è¯´æ˜ï¼ˆå¯é€‰ï¼‰ï¼š                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å……å€¼é‡‘é¢Â¥1000éœ€å®Œæˆ1å€æµæ°´æ‰å¯ææ¬¾ï¼Œ            â”‚ â”‚
â”‚ â”‚ å½“å‰æµæ°´ï¼šÂ¥600ï¼Œè¿˜éœ€ï¼šÂ¥400                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ [ ] å‘é€ç«™å†…ä¿¡é€šçŸ¥ç©å®¶                               â”‚
â”‚                                                     â”‚
â”‚ [å–æ¶ˆ] [ç¡®è®¤æ‹’ç»]                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¨¡æ¿ç®¡ç†é¡µé¢**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‹’ç»åŸå› æ¨¡æ¿ç®¡ç†                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [+ æ–°å»ºæ¨¡æ¿]                                         â”‚
â”‚                                                     â”‚
â”‚ æ¨¡æ¿åˆ—è¡¨ï¼š                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ¨¡æ¿åç§°          | ä½¿ç”¨æ¬¡æ•° | æ“ä½œ              â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ æµæ°´ä¸è¶³          | 23æ¬¡    | [ç¼–è¾‘] [åˆ é™¤]    â”‚ â”‚
â”‚ â”‚ é“¶è¡Œå¡ä¿¡æ¯ä¸ç¬¦    | 18æ¬¡    | [ç¼–è¾‘] [åˆ é™¤]    â”‚ â”‚
â”‚ â”‚ é‡å¤ææ¬¾          | 12æ¬¡    | [ç¼–è¾‘] [åˆ é™¤]    â”‚ â”‚
â”‚ â”‚ è´¦æˆ·å¼‚å¸¸          | 9æ¬¡     | [ç¼–è¾‘] [åˆ é™¤]    â”‚ â”‚
â”‚ â”‚ æœªå®Œæˆå®åè®¤è¯    | 7æ¬¡     | [ç¼–è¾‘] [åˆ é™¤]    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€æœ¯å®ç°

```sql
-- æ‹’ç»åŸå› æ¨¡æ¿è¡¨
CREATE TABLE rejection_templates (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  category TEXT NOT NULL,               -- åˆ†ç±»ï¼šwithdrawal, commission, etc
  title TEXT NOT NULL,                  -- æ¨¡æ¿æ ‡é¢˜
  content TEXT NOT NULL,                -- æ¨¡æ¿å†…å®¹
  usage_count INTEGER DEFAULT 0,        -- ä½¿ç”¨æ¬¡æ•°
  created_by INTEGER,                   -- åˆ›å»ºäºº
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME
);

-- åˆå§‹åŒ–æ¨¡æ¿
INSERT INTO rejection_templates (category, title, content) VALUES
  ('withdrawal', 'æµæ°´ä¸è¶³', 'å……å€¼é‡‘é¢Â¥Xéœ€å®Œæˆ1å€æµæ°´æ‰å¯ææ¬¾ï¼Œå½“å‰æµæ°´ä¸è¶³'),
  ('withdrawal', 'é“¶è¡Œå¡ä¿¡æ¯ä¸ç¬¦', 'é“¶è¡Œå¡æŒå¡äººå§“åä¸æ³¨å†Œå§“åä¸ä¸€è‡´ï¼Œè¯·æ ¸å¯¹åé‡æ–°æäº¤'),
  ('withdrawal', 'é‡å¤ææ¬¾', 'ä»Šæ—¥å·²ææ¬¾3æ¬¡ï¼Œå·²è¾¾æ¯æ—¥ææ¬¾æ¬¡æ•°é™åˆ¶'),
  ('withdrawal', 'è´¦æˆ·å¼‚å¸¸', 'è´¦æˆ·å­˜åœ¨å¼‚å¸¸è¡Œä¸ºï¼Œéœ€è”ç³»å®¢æœæ ¸å®èº«ä»½åå†ç”³è¯·ææ¬¾'),
  ('withdrawal', 'æœªå®Œæˆå®åè®¤è¯', 'è¯·å…ˆå®Œæˆå®åè®¤è¯åå†ç”³è¯·ææ¬¾');
```

```typescript
// è·å–æ‹’ç»åŸå› æ¨¡æ¿
app.get('/api/rejection-templates/:category', async (c) => {
  const { DB } = c.env
  const { category } = c.req.param()
  
  const templates = await DB.prepare(`
    SELECT * FROM rejection_templates 
    WHERE category = ?
    ORDER BY usage_count DESC, id
  `).bind(category).all()
  
  return c.json({ templates: templates.results })
})

// ä½¿ç”¨æ¨¡æ¿å¹¶è®°å½•ä½¿ç”¨æ¬¡æ•°
async function useTemplate(templateId: number, db: D1Database) {
  await db.prepare(`
    UPDATE rejection_templates 
    SET usage_count = usage_count + 1 
    WHERE id = ?
  `).bind(templateId).run()
  
  const template = await db.prepare(`
    SELECT content FROM rejection_templates WHERE id = ?
  `).bind(templateId).first()
  
  return template.content
}
```

#### é¢„æœŸæ”¶ç›Š
- âœ… å®¡æ ¸æ•ˆç‡æå‡ **50%**ï¼ˆæ— éœ€æ‰‹åŠ¨è¾“å…¥ï¼‰
- âœ… è§„èŒƒåŒ–æ‹’ç»åŸå› ï¼Œå‡å°‘æ²Ÿé€šæˆæœ¬
- âœ… å¸¸ç”¨åŸå› å¿«é€Ÿé€‰æ‹©
- âœ… ç»Ÿè®¡ä½¿ç”¨é¢‘ç‡ï¼Œä¼˜åŒ–æ¨¡æ¿åº“

---

### 5ï¸âƒ£ å†å²è¿è§„è®°å½•ï¼ˆåŠŸèƒ½ç¼–å·ï¼š2.1.5ï¼‰

#### ä¸šåŠ¡åœºæ™¯
- å®¡æ ¸ææ¬¾æ—¶éœ€è¦æŸ¥çœ‹ç©å®¶å†å²è¿è§„æƒ…å†µ
- é‡å¤è¿è§„ç©å®¶éœ€è¦æ›´ä¸¥æ ¼å®¡æ ¸
- å†å²è®°å½•åˆ†æ•£åœ¨ä¸åŒé¡µé¢ï¼ŒæŸ¥è¯¢å›°éš¾

#### åŠŸèƒ½è®¾è®¡

**ææ¬¾å®¡æ ¸ - ç©å®¶å†å²è®°å½•**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ææ¬¾å®¡æ ¸ - ç©å®¶è¯¦æƒ…                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸºæœ¬ä¿¡æ¯ï¼š                                           â”‚
â”‚ è´¦å·ï¼šplayer123  |  VIPç­‰çº§ï¼šVIP2  |  çŠ¶æ€ï¼šæ­£å¸¸    â”‚
â”‚ æ³¨å†Œæ—¶é—´ï¼š2025-10-01  |  æœ€è¿‘ç™»å½•ï¼š2025-12-13      â”‚
â”‚                                                     â”‚
â”‚ è´¢åŠ¡ä¿¡æ¯ï¼š                                           â”‚
â”‚ å½“å‰ä½™é¢ï¼šÂ¥3,500  |  ç´¯è®¡å……å€¼ï¼šÂ¥50,000             â”‚
â”‚ ç´¯è®¡ææ¬¾ï¼šÂ¥35,000  |  ç´¯è®¡è¾“èµ¢ï¼š-Â¥8,500            â”‚
â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ å†å²è¿è§„è®°å½•ï¼ˆå…±3æ¡ï¼‰                             â”‚
â”‚                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 2025-12-10 15:30                                â”‚ â”‚
â”‚ â”‚ ç±»å‹ï¼š[ææ¬¾å¼‚å¸¸]                                â”‚ â”‚
â”‚ â”‚ æè¿°ï¼šæäº¤è™šå‡é“¶è¡Œå¡ä¿¡æ¯                        â”‚ â”‚
â”‚ â”‚ å¤„ç†ï¼šæ‹’ç»ææ¬¾ï¼Œè­¦å‘Šå¤„ç†                        â”‚ â”‚
â”‚ â”‚ å¤„ç†äººï¼šadmin                                   â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 2025-12-05 10:15                                â”‚ â”‚
â”‚ â”‚ ç±»å‹ï¼š[åˆ·æ°´å«Œç–‘]                                â”‚ â”‚
â”‚ â”‚ æè¿°ï¼šä¸è´¦æˆ·ID1234ã€ID5678åŒIPå¯¹æ‰“             â”‚ â”‚
â”‚ â”‚ å¤„ç†ï¼šæ ‡è®°è§‚å¯Ÿï¼Œé™åˆ¶VIPå‡çº§                    â”‚ â”‚
â”‚ â”‚ å¤„ç†äººï¼šadmin                                   â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 2025-11-28 14:20                                â”‚ â”‚
â”‚ â”‚ ç±»å‹ï¼š[æ¶æ„æŠ•è¯‰]                                â”‚ â”‚
â”‚ â”‚ æè¿°ï¼šæ•…æ„è¾“å…‰åæ¶æ„æŠ•è¯‰è¦æ±‚é€€æ¬¾               â”‚ â”‚
â”‚ â”‚ å¤„ç†ï¼šé©³å›æŠ•è¯‰ï¼Œæ ‡è®°é»‘åå•è§‚å¯Ÿ                  â”‚ â”‚
â”‚ â”‚ å¤„ç†äººï¼šadmin                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ è¿‘æœŸææ¬¾è®°å½•ï¼ˆæœ€è¿‘5ç¬”ï¼‰ï¼š                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ—¶é—´          | é‡‘é¢    | çŠ¶æ€   | å¤„ç†äºº       â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 12-12 14:30  | Â¥1,000  | å·²é€šè¿‡ | admin       â”‚ â”‚
â”‚ â”‚ 12-10 10:20  | Â¥800    | å·²æ‹’ç» | admin       â”‚ â”‚
â”‚ â”‚ 12-08 15:45  | Â¥1,500  | å·²é€šè¿‡ | admin       â”‚ â”‚
â”‚ â”‚ 12-05 09:30  | Â¥500    | å·²é€šè¿‡ | admin       â”‚ â”‚
â”‚ â”‚ 12-01 16:10  | Â¥2,000  | å·²é€šè¿‡ | admin       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚ é£æ§å»ºè®®ï¼š                                           â”‚
â”‚ ğŸ’¡ è¯¥ç©å®¶æœ‰3æ¬¡è¿è§„è®°å½•ï¼Œå»ºè®®åŠ å¼ºå®¡æ ¸                 â”‚
â”‚                                                     â”‚
â”‚ [å…³é—­] [å®¡æ ¸é€šè¿‡] [æ‹’ç»]                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æŠ€æœ¯å®ç°

```sql
-- è¿è§„è®°å½•è¡¨
CREATE TABLE violation_records (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  player_id INTEGER NOT NULL,           -- ç©å®¶ID
  violation_type TEXT NOT NULL,         -- è¿è§„ç±»å‹
  description TEXT,                     -- æè¿°
  action_taken TEXT,                    -- å¤„ç†æªæ–½
  severity TEXT,                        -- ä¸¥é‡ç¨‹åº¦ï¼šlow, medium, high
  handled_by INTEGER,                   -- å¤„ç†äºº
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (player_id) REFERENCES players(id)
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_violation_player ON violation_records(player_id, created_at DESC);
```

```typescript
// è·å–ç©å®¶å†å²è¿è§„è®°å½•
app.get('/api/players/:id/violations', async (c) => {
  const { DB } = c.env
  const { id } = c.req.param()
  
  const violations = await DB.prepare(`
    SELECT v.*, u.username as handler_name
    FROM violation_records v
    LEFT JOIN users u ON v.handled_by = u.id
    WHERE v.player_id = ?
    ORDER BY v.created_at DESC
    LIMIT 10
  `).bind(id).all()
  
  return c.json({ violations: violations.results })
})

// æ·»åŠ è¿è§„è®°å½•
app.post('/api/players/:id/violations', async (c) => {
  const { DB } = c.env
  const { id } = c.req.param()
  const { violation_type, description, action_taken, severity, operator_id } = await c.req.json()
  
  await DB.prepare(`
    INSERT INTO violation_records 
    (player_id, violation_type, description, action_taken, severity, handled_by)
    VALUES (?, ?, ?, ?, ?, ?)
  `).bind(id, violation_type, description, action_taken, severity, operator_id).run()
  
  return c.json({ success: true })
})
```

#### é¢„æœŸæ”¶ç›Š
- âœ… å®¡æ ¸å†³ç­–æ›´å‡†ç¡®ï¼ˆåŸºäºå†å²è®°å½•ï¼‰
- âœ… å‡å°‘é‡å¤è¿è§„ç©å®¶çš„é£é™©
- âœ… å®Œæ•´çš„è¿è§„è®°å½•è¿½æº¯
- âœ… é£æ§èƒ½åŠ›æå‡

---

## æ€»ç»“

### æ ¸å¿ƒä»·å€¼å¯¹æ¯”

| åŠŸèƒ½ | æ ¸å¿ƒä»·å€¼ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|
| åŠŸèƒ½å¼€å…³ | ç§’çº§ç´§æ€¥å“åº” | ç³»ç»Ÿæ•…éšœã€ç»´æŠ¤ |
| ç»´æŠ¤æ¨¡å¼ | ä¸“ä¸šç»´æŠ¤ä½“éªŒ | ç³»ç»Ÿå‡çº§ |
| ç³»ç»Ÿå‚æ•°é…ç½® | çµæ´»ä¸šåŠ¡è°ƒæ•´ | è¿è¥ç­–ç•¥è°ƒæ•´ |
| æ‹’ç»åŸå› æ¨¡ç‰ˆ | è§„èŒƒåŒ–æ“ä½œ | å®¡æ ¸æµç¨‹ |
| å†å²è¿è§„è®°å½• | é£æ§å†³ç­–æ”¯æŒ | ç©å®¶å®¡æ ¸ |

### å®æ–½ä¼˜å…ˆçº§å»ºè®®

**ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ˆç«‹å³å®æ–½ï¼‰**:
- âœ… åŠŸèƒ½å¼€å…³ - ç´§æ€¥å“åº”å¿…éœ€
- âœ… ç³»ç»Ÿå‚æ•°é…ç½® - çµæ´»è°ƒæ•´å¿…éœ€

**ç¬¬äºŒä¼˜å…ˆçº§ï¼ˆè¿‘æœŸå®æ–½ï¼‰**:
- âœ… ç»´æŠ¤æ¨¡å¼ - æå‡ä¸“ä¸šåº¦
- âœ… æ‹’ç»åŸå› æ¨¡ç‰ˆ - æå‡æ•ˆç‡

**ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼ˆæŒ‰éœ€å®æ–½ï¼‰**:
- âœ… å†å²è¿è§„è®°å½• - é£æ§å¢å¼º

---

**æ–‡æ¡£ç‰ˆæœ¬**: V1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-12-13  
**ç»´æŠ¤è€…**: AI Assistant (Claude Code)

---

Â© 2025 çœŸäººè·å®˜è§†è®¯ç³»ç»Ÿ. All Rights Reserved.
